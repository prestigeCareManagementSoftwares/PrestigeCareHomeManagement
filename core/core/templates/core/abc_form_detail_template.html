{% extends "core/base.html" %}
{% block content %}
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>ABC Behaviour Form #{{ data.id }}</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            font-size: 11px;
            line-height: 1.3;
            padding: 10px;
            margin: 0;
        }
        h1 {
            text-align: center;
            font-size: 14px;
            margin-bottom: 15px;
        }
        .form-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 5px;
            table-layout: fixed;
        }
        .form-table td {
            border: 1px solid #000;
            padding: 6px;
            vertical-align: top;
            word-wrap: break-word;
            overflow-wrap: break-word;
        }
        .form-table tr td:first-child {
            width: 50%;
        }
        .form-table tr td:last-child {
            width: 50%;
        }
        .section-header {
            font-weight: bold;
            background-color: #f0f0f0;
        }
        .underline {
            text-decoration: underline;
        }
        p {
            margin: 0 0 10px 0;
        }
        /* Print-specific styles */
        @media print {
            body {
                padding: 10px !important;
                background: white !important;
            }
            .no-print {
                display: none !important;
            }
        }
        /* Screen-specific styles */
        @media screen {
            body {
                background-color: #f5f5f5;
                padding-top: 20px;
            }
            .print-content {
                background-color: white;
                box-shadow: 0 0 10px rgba(0,0,0,0.1);
                max-width: 900px;
                margin: 0 auto;
                padding: 20px;
            }
            .print-actions {
                text-align: center;
                margin: 0 auto 20px;
                max-width: 900px;
            }
        }
        /* Copy protection styles */
        .protected-content {
            user-select: none;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            position: relative;
        }
        .protected-content::after {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="400" height="400" opacity="0.05"><text x="50" y="50" font-family="Arial" font-size="20" transform="rotate(-30)">CONFIDENTIAL</text></svg>');
            pointer-events: none;
            z-index: 1;
        }
    </style>
</head>
<body>
<div class="print-actions no-print">
    <a href="{% url 'download_abc_pdf' form_id=data.id %}" class="btn btn-primary">
        <i class="fas fa-file-pdf"></i> Download PDF
    </a>
    <button onclick="window.print()" class="btn btn-secondary">
        <i class="fas fa-print"></i> Print Form
    </button>
</div>

<div class="print-content protected-content">
    <h1>ABC Behaviour Monitoring Form</h1>

    <p><strong>Target behaviours:</strong> <span class="underline">
        {% for behaviour in data.target_behaviours %}
            {{ behaviour }}{% if not forloop.last %}, {% endif %}
        {% endfor %}
    </span></p>

    <table class="form-table">
        <tr>
            <td><strong>Service User:</strong> {{ data.service_user }}</td>
            <td><strong>Date of Birth:</strong> {{ data.date_of_birth|date:"d/m/Y" }}</td>
        </tr>
        <tr>
            <td><strong>Staff:</strong> {{ data.staff }}</td>
            <td><strong>DATE/TIME Behavior started:</strong> {{ data.date_time|date:"d/m/Y H:i" }}</td>
        </tr>
        <tr>
            <td colspan="2" class="section-header">SETTING <br> Where? Who was present? What was happening? Describe the environment â€“ noise, temperature?</td>
        </tr>
        <tr>
            <td colspan="2" style="height: 60px;">{{ data.setting|linebreaks }}</td>
        </tr>
        <tr>
            <td colspan="2" class="section-header">ANTECEDENT <br> What happened just before the behaviour started? Change? Noise? Waiting?</td>
        </tr>
        <tr>
            <td colspan="2" style="height: 60px;">{{ data.antecedent|linebreaks }}</td>
        </tr>
        <tr>
            <td colspan="2" class="section-header">BEHAVIOUR <br>Describe exactly what the client did</td>
        </tr>
        <tr>
            <td colspan="2" style="height: 60px;">{{ data.behaviour|linebreaks }}</td>
        </tr>
        <tr>
            <td colspan="2" class="section-header">CONSEQUENCES <br> What happened after the behaviour took place? What did you do?</td>
        </tr>
        <tr>
            <td colspan="2" style="height: 60px;">{{ data.consequences|linebreaks }}</td>
        </tr>
        <tr>
            <td colspan="2" class="section-header">REFLECTION <br> What can we learn from this situation & take forward whilst supporting the client? Any other relevant information?</td>
        </tr>
        <tr>
            <td colspan="2" style="height: 60px;">{{ data.reflection|linebreaks }}</td>
        </tr>
    </table>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Prevent right-click
        document.addEventListener('contextmenu', function(e) {
            e.preventDefault();
            alert('Copying content is not permitted');
        });

        // Prevent text selection
        document.addEventListener('selectstart', function(e) {
            e.preventDefault();
        });

        // Prevent keyboard shortcuts (Ctrl+C, Ctrl+A, etc.)
        document.addEventListener('keydown', function(e) {
            if (e.ctrlKey && (e.key === 'c' || e.key === 'C' ||
                              e.key === 'x' || e.key === 'X' ||
                              e.key === 'a' || e.key === 'A')) {
                e.preventDefault();
                alert('Copying content is not permitted');
            }
        });
    });
</script>
</body>
</html>
{% endblock %}